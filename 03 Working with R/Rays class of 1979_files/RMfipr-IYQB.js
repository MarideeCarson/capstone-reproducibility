/*!CK:2741247129!*//*1460655581,*/

if (self.CavalryLogger) { CavalryLogger.start_js(["v3+43"]); }

__d('ActivityLogStory',['ge','DOM','Event','Toggler','Run'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={removeStory:function(i,j){var k=c('ge')(i);k&&c('DOM').setContent(k,j);},registerPopover:function(i){var j=c('Event').listen(window,'scroll',function(k){c('Toggler').hide(i);});c('Run').onLeave(j.remove.bind(j));}};f.exports=h;},null);
__d('AllActivityContentLoader',['csx','Arbiter','CSS','DOM','DOMScroll','OnVisible','Parent','MorePagerFetchOnScroll','TimelineComponentKeys','TimelineConstants','TimelineController','TimelineLegacySections','TimelineSmartInsert','UIPagelet','Vector','$','clickRefAction'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();var i=false,j=0,k=null,l={},m=[],n={},o=[],p=null;function q(u,v,w,x,y){this.node=u;this._canScrollLoad=true;this.scrubberKey=v;this._pageletLoadData=w;this.loaded=x;this.sortKey=y;this.contentNode=c('DOM').scry(u,"div._z6j")[0];}function r(){if(i)return;c('TimelineController').register(c('TimelineComponentKeys').CONTENT,t);c('clickRefAction')('scrubber').set_namespace('allactivity');i=true;}function s(u){var v=c('TimelineLegacySections').get(u);v&&v._canScrollLoad&&v.load();}Object.assign(q.prototype,{load:function(){if(this.loaded)return;this.loaded=true;this.contentNode&&c('CSS').hide(this.contentNode);c('CSS').show(c('Parent').byClass(this.node,'fbTimelineSection'));var u=this.node;function v(x){c('TimelineSmartInsert').run(u,x);}var w=c('DOM').find(this.node,'div.fbTimelineLogStream');o.push(c('UIPagelet').loadFromEndpoint('TimelineEntStoryActivityLogPagelet',w.id,this._pageletLoadData,{usePipe:true,jsNonblock:true,constHeight:true,displayCallback:v,append:true}));},contentAdded:function(u){if(!this.hasContent){c('CSS').removeClass(c('Parent').byClass(this.node,'stat_elem'),'async_saving');if(this.contentNode){u&&c('DOM').prependContent(this.contentNode,u);c('CSS').show(this.contentNode);}this.hasContent=true;}},fullyLoaded:function(){if(!this.hasContent){c('CSS').removeClass(c('Parent').byClass(this.node,'stat_elem'),'async_saving');c('CSS').show(c('DOM').find(this.node,"div._40pu"));this.contentNode&&c('CSS').hide(this.contentNode);}},activateScrollLoad:function(){this._canScrollLoad=true;n[this.scrubberKey]&&n[this.scrubberKey].reset();},deactivateScrollLoad:function(){if(!this.loaded){this._canScrollLoad=false;}else{var u=c('DOM').scry(this.node,'.uiMorePager');if(u)u.map(function(v){var w=c('MorePagerFetchOnScroll').getInstance(v.id);w&&w.removeEventListeners();});}n[this.scrubberKey]&&n[this.scrubberKey].remove();},getParent:function(){if(this.parentKey)return c('TimelineLegacySections').get(this.parentKey);return null;}});var t={SCROLL_TO_OFFSET:115,HEADER_SCROLL_CUTOFF:30,CURRENT_SECTION_OFFSET:150,registerTimePeriod:function(u,v,w,x,y,z){r();var aa=new q(u,v,w,x,z);if(!y){m.push(v);l[v]=true;}else{aa.parentKey=y;c('TimelineLegacySections').get(y).subSections=c('TimelineLegacySections').get(y).subSections||[];c('TimelineLegacySections').get(y).subSections.push(aa);c('TimelineLegacySections').get(y).subSections.sort(function(ba,ca){return ca.sortKey-ba.sortKey;});}c('TimelineLegacySections').set(v,aa);t.checkCurrentSectionChange();c('Arbiter').inform(c('TimelineConstants').SECTION_REGISTERED,{scrubberKey:v},c('Arbiter').BEHAVIOR_PERSISTENT);},reset:function(){t.stopLoadingContent();i=false;c('TimelineLegacySections').removeAll();j=0;k=null;l={};m=[];n={};o=[];p=null;},stopLoadingContent:function(){for(var u in n)n[u]&&n[u].remove();for(var v=0;v<o.length;v++)o[v].cancel();},setContentHeader:function(u){p=u;},checkCurrentSectionChange:function(){var u=t.getCurrentSection(),v=k&&k.scrubberKey;if(u&&u.scrubberKey!==v){k=u;var w=u.scrubberKey,x=u.parentKey;if(!x){x=w;w=null;}c('TimelineController').sectionHasChanged(x,w);}},getCurrentSection:function(){var u={},v=c('TimelineLegacySections').getAll();for(var w in v){var x=v[w];if(!x.loaded)continue;var y=c('Vector').getElementPosition(x.node,'viewport').y;if(y<t.CURRENT_SECTION_OFFSET)u[y]=x;}var z=Math.max.apply(this,Object.keys(u)),aa=z==-Infinity;if(!aa){return u[z];}else return null;},enableScrollLoad:function(u,v,w){u=c('$')(u);var x=t.getNextSectionKey(v);if(x)n[x]=new (c('OnVisible'))(u,s.bind(null,x),false,w||1000);},getNextSectionKey:function(u){var v=c('TimelineLegacySections').get(u),w=v.getParent(),x=null,y=null;if(w)for(var z=0;z<w.subSections.length-1;z++)if(w.subSections[z].scrubberKey==u)x=w.subSections[z+1].scrubberKey;if(!x)for(var aa=0;aa<m.length-aa;aa++)if(m[aa]==w.scrubberKey){y=c('TimelineLegacySections').get(m[aa+1]).subSections[0];if(y)x=y.scrubberKey;}return x;},navigateToSection:function(u,v,w){v=!!v;var x=c('TimelineLegacySections').get(u);if(!x)return;if(!x.getParent()){u=x.subSections[0].scrubberKey;x=c('TimelineLegacySections').get(u);}for(var y=0;y<m.length;y++){var z=c('TimelineLegacySections').get(m[y]);for(var aa=0;aa<z.subSections.length;aa++){if(z.subSections[aa].scrubberKey==u)break;z.subSections[aa].deactivateScrollLoad();}if(z.scrubberKey==x.getParent().scrubberKey)break;}x.activateScrollLoad();x.load();t.adjustContentPadding();var ba=c('Vector').getScrollPosition().x,ca=c('Vector').getElementPosition(x.node).y;if(!v){var da=t.SCROLL_TO_OFFSET;c('DOMScroll').scrollTo(new (c('Vector'))(ba,ca-da,'document'));}},adjustContentPadding:function(){c('$')('fbTimelineLogBody').style.paddingBottom=c('Vector').getViewportDimensions().y-t.CURRENT_SECTION_OFFSET-t.HEADER_SCROLL_CUTOFF+'px';},sectionHasContent:function(u){var v=c('TimelineLegacySections').get(u);v&&v.contentAdded(p);p=null;},sectionFullyLoaded:function(u){var v=c('TimelineLegacySections').get(u);v&&v.fullyLoaded();}};f.exports=t;},null);
__d('ActivityLogSearch',['Event','CSS','DOM','Input','Run'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i,j,k){var l=c('DOM').find(k,'.inputtext'),m=c('Event').listen(j,'click',function(){c('CSS').hide(i);c('CSS').show(k);l.focus();});c('Run').onLeave(m.remove.bind(m));var n=c('Event').listen(l,'blur',function(){if(!c('Input').getValue(l)){c('CSS').hide(k);c('CSS').show(i);}});c('Run').onLeave(n.remove.bind(n));}f.exports=h;},null);
__d('PopoverMenuDynamicTooltip',['csx','DOMQuery','Tooltip'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(j){'use strict';this._popoverMenu=j;this._setMenuSubscription=null;this._changeSubscription=null;}i.prototype.enable=function(){'use strict';this._setMenuSubscription=this._popoverMenu.subscribe('setMenu',this._onSetMenu.bind(this));};i.prototype.disable=function(){'use strict';this._popoverMenu.unsubscribe(this._setMenuSubscription);this._setMenuSubscription=null;this._removeChangeSubscription();};i.prototype._onSetMenu=function(){'use strict';this._removeChangeSubscription();this._menu=this._popoverMenu.getMenu();this._changeSubscription=this._menu.subscribe('change',function(j,k){var l=k.item;if(k[0])l=k[0].item;if(!l)return;var m=l.getLabel();m=m?m.toString():null;if(!m)return;var n=this._popoverMenu.getTriggerElem(),o=c('DOMQuery').scry(n,"span._55pe")[0];if(o&&o.nodeName){var p=o.parentNode;if(p)c('Tooltip').set(p,m);}}.bind(this));};i.prototype._removeChangeSubscription=function(){'use strict';if(this._changeSubscription){this._menu.unsubscribe(this._changeSubscription);this._changeSubscription=null;}};f.exports=i;},null);
__d('ScrollHighlight',['DOMScroll','highlight'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={actOn:function(i,j,k){c('DOMScroll').scrollTo(i,true,false,false,k);c('highlight')(i,null,j);}};f.exports=h;},null);
__d('ProfileApprovalController',['AsyncRequest','DOM','Event','HTML','$','ge'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();function h(i){'use strict';this.queueType=i;var j=c('ge')('profileApprovalSeeMoreLink');if(j)c('Event').listen(j,'click',this.clickedSeeMore.bind(this));}h.prototype.getNewStories=function(){'use strict';var i=this.getStoryData(),j={filter:this.FILTER_NEWER,filter_timestamp:i.newest_time,filter_fbid:i.newest_fbid};new (c('AsyncRequest'))().setURI('/ajax/profile/approval/get_more.php').setData(j).setHandler(this.handleContent).send();};h.prototype.clickedSeeMore=function(){'use strict';var i=this.getStoryData(),j={queue_type:this.queueType,filter:this.FILTER_OLDER,filter_timestamp:i.oldest_time,filter_fbid:i.oldest_fbid};new (c('AsyncRequest'))().setURI('/ajax/profile/approval/get_more.php').setData(j).setHandler(this.handleContent).send();};h.prototype.handleContent=function(i){'use strict';var j=i.payload;if(j.pager_error){c('DOM').replace(c('$')('profileApprovalSeeMoreContainer'),c('HTML')(j.pager_markup));return;}if(j.hide_more_pager)c('DOM').remove(c('$')('profileApprovalSeeMoreContainer'));if(!j.items_markup)return;if(j.insert_before)c('DOM').prependContent(c('DOM').find(c('$')('profileApprovalContentContainer'),'.profileApprovalList'),c('HTML')(j.items_markup));if(j.insert_after)c('DOM').appendContent(c('DOM').find(c('$')('profileApprovalContentContainer'),'.profileApprovalList'),c('HTML')(j.items_markup));};h.prototype.getStoryData=function(){'use strict';var i=c('DOM').scry(c('$')('profileApprovalContentContainer'),'.profileApprovalStoryContainer');if(!i)return;var j=i[0],k=i[i.length-1];return {newest_time:j.getAttribute('data-timestamp'),newest_fbid:j.getAttribute('data-fbid'),oldest_time:k.getAttribute('data-timestamp'),oldest_fbid:k.getAttribute('data-fbid')};};h.NO_MORE_CONTENT='no_more_content';Object.assign(h.prototype,{FILTER_NONE:0,FILTER_OLDER:1,FILTER_NEWER:2});f.exports=h;},null);
__d('legacy:profile-approval-controller',['ProfileApprovalController'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();b.ProfileApprovalController=c('ProfileApprovalController');},3);
__d('TimelineAllActivitySideNav',['csx','$','CSS','DOMQuery','FutureSideNav','PageTransitions','Scroll','Style','UIPagelet','ge','getOrCreateDOMID','getViewportDimensions'],function a(b,c,d,e,f,g,h){if(c.__markCompiled)c.__markCompiled();function i(k){var l=k==='review'||k==='tagreview',m=c('ge')('rightColContent'),n=m&&c('DOMQuery').scry(m,".fbTimelineLogScrubber")[0];n&&c('CSS').conditionShow(n,!l);}var j={init:function(k,l,m,n,o){var p=c('DOMQuery').find(c('$')('contentArea'),"._6-0"),q=c('getOrCreateDOMID')(p);c('Style').set(p,'minHeight',c('getViewportDimensions')().height+'px');c('CSS').addClass(k,'fixed_elem');i(o||'all');c('PageTransitions').registerHandler(function(r){if(l===r.getPath()&&r.getQueryData().sk==m){var s=babelHelpers['extends']({profile_id:n,renderContentsOnly:1,uripath:r.toString()},r.getQueryData()),t=c('FutureSideNav').getInstance(),u=t&&t._getItemForKey(s.log_filter||'all');u&&t.setLoading(u);c('UIPagelet').loadFromEndpoint('TimelineAllActivityColumn',q,s,{jsNonblock:true,constHeight:true,displayCallback:function(v){v();u&&t.setSelected(u);c('Scroll').setTop(document.body,0);i(s.log_filter||'all');c('PageTransitions').transitionComplete(true);}});return true;}return false;});}};f.exports=j;},null);
__d('ApprovalQueueCountUpdater',['Arbiter','DOM','NavigationMessage','ge'],function a(b,c,d,e,f,g){if(c.__markCompiled)c.__markCompiled();var h={updateCounts:function(i,j,k){var l=i.friends+i.others,m=c('ge')('tag_count_friends'),n=c('ge')('tag_count_other');c('Arbiter').inform(c('NavigationMessage').NAVIGATION_COUNT_UPDATE,{key:'review',count:l<=k?l:k,hide:true});if(m)c('DOM').setContent(m,i.friends<=j?i.friends:j+'+');if(n)c('DOM').setContent(n,i.others<=j?i.others:j+'+');}};f.exports=h;},null);